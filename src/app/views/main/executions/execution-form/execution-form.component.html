<app-card>
  <div class="row form-card">
    <div class="col-12 mt-3">
      <form [formGroup]="executionForm">
        <div class="row d-flex justify-content-center">
          <div class="col-md-6">
            <div class="icon-wave">
              <i class="fas fa-wave-square"></i>
            </div>
            <h4 class="title">New Execution</h4>
            <p class="subtitle">To create an execution, select a dataset and the desired pipeline</p>
            <div class="row">
              <div class="col-12 d-flex flex-column mb-3">

                <div class="label-float">
                  <input [class.error]="getControlError('description')" type="text" placeholder=" " formControlName="description" />
                  <label [class.error]="getControlError('description')">Description</label>
                </div>
                <app-input-validation [control]="executionForm.get('description')"></app-input-validation>

                <div class="label-float">
                  <select [class.error]="getControlError('projectId')" placeholder=" " formControlName="projectId">
                    <option value="1">Select a project</option>
                    <option [value]="project.id" *ngFor="let project of projects">{{project.name}}</option>
                  </select>
                  <label [class.error]="getControlError('projectId')">Project</label>
                </div>
                <app-input-validation [control]="executionForm.get('projectId')"></app-input-validation>


                <div class="label-float">
                  <select [class.error]="getControlError('datasetId')" placeholder=" " formControlName="datasetId">
                    <option value="1">Select the dataset</option>
                    <option [value]="dataset.id" *ngFor="let dataset of selectedProject?.datasets">{{dataset.filename}}
                    </option>
                  </select>
                  <label [class.error]="getControlError('datasetId')">Dataset</label>
                </div>
                <app-input-validation [control]="executionForm.get('datasetId')"></app-input-validation>


                <div class="label-float">
                  <select [class.error]="getControlError('pipelineId')" placeholder=" " formControlName="pipelineId">
                    <option value="1">Select the pipeline</option>
                    <option [value]="pipeline.id" *ngFor="let pipeline of pipelines">{{pipeline.description}}
                    </option>
                  </select>
                  <label [class.error]="getControlError('pipelineId')">Pipeline</label>
                </div>
                <app-input-validation [control]="executionForm.get('pipelineId')"></app-input-validation>

                <!-- <div class="steps mt-3 mb-1"
                *ngFor="let item of executionForm.get('executionSteps')['controls']; let index=index"
                formArrayName="executionSteps">
                <p class="step-name">Step {{index + 1}}</p>
                <div [formGroupName]="index">
                  <div class="label-float">
                    <select placeholder=" " formControlName="providerId" (change)="setProvider()">
                      <option value="1">Selecione o serviço</option>
                      <option [value]="provider.id" *ngFor="let provider of providers">{{provider.name}}</option>
                    </select>
                    <label>Serviço</label>
                  </div>

                  <div class="label-float">
                    <select placeholder=" " formControlName="outputType">
                      <option value="1">Selecione o formato do output</option>
                      <option [value]="output" *ngFor="let output of selectedProviders[index]?.outputSupportedTypes">
                        {{output}}</option>
                    </select>
                    <label>Formato do Output</label>
                  </div>
                </div>

                <div class="d-flex justify-content-between align-items-center mt-3">
                  <div class="line"
                    [class.total]="(index !== executionForm.get('executionSteps')['controls'].length -1)">
                  </div>
                  <button class="plus" (click)="addStep()"
                    *ngIf="index === (executionForm.get('executionSteps')['controls'].length -1)">+</button>
                </div>
                </div> -->
              </div>
              <div class="col-6 d-flex align-items-end mt-5 mb-3">
                <p class="back" [routerLink]="['/executions']" routerLinkActive="router-link-active">Voltar</p>
              </div>
              <div class="col-6 d-flex flex-column mt-5 mb-3">
                <button (click)="createExecution()">Begin Execution</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</app-card>